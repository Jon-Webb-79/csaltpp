<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>csalt++: /home/jonwebb/Code_Dev/C++/csalt++/csalt++/include/matrix.hpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">csalt++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/home/jonwebb/Code_Dev/C++/csalt++/csalt++/include/matrix.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Compares two sparse COO matrices for equality.Determines whether this matrix and the given matrix are equal by checking:</p><ul>
<li>Matrix dimensions (rows and columns),</li>
<li>Number of non-zero entries,</li>
<li>Each corresponding (row, col, value) triple.</li>
</ul>
<p>If both matrices are finalized (i.e., <code>fast_set == false</code>), a direct comparison of the underlying storage is used. If either matrix is not finalized, both matrices are converted to dense format and compared entry-wise.</p>
<p>For floating-point types, approximate comparison is used with a tolerance of <code>1e-6</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The matrix to compare against. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the matrices are equal, false otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Equality is defined structurally and numerically. Two matrices with the same non-zero values but in different insertion orders will still compare equal if finalized.</dd></dl>
<div class="fragment"><div class="line"><a name="_a0"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html">slt::SparseCOOMatrix&lt;float&gt;</a> A(2, 2);</div>
<div class="line">A.set(0, 0, 1.0f);</div>
<div class="line">A.set(1, 1, 2.0f);</div>
<div class="line">A.finalize();</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classslt_1_1SparseCOOMatrix.html">slt::SparseCOOMatrix&lt;float&gt;</a> B(2, 2);</div>
<div class="line">B.set(0, 0, 1.0f);</div>
<div class="line">B.set(1, 1, 2.0f);</div>
<div class="line">B.finalize();</div>
<div class="line"> </div>
<div class="line">assert(A == B);  <span class="comment">// true</span></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html">slt::SparseCOOMatrix</a></div><div class="ttdoc">A sparse matrix implementation using the Coordinate List (COO) format.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2237</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// - File:    matrix.hpp</span></div>
<div class="line"><span class="comment">// - Purpose: Describe the file purpose here</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Source Metadata</span></div>
<div class="line"><span class="comment">// - Author:  Jonathan A. Webb</span></div>
<div class="line"><span class="comment">// - Date:    May 31, 2025</span></div>
<div class="line"><span class="comment">// - Version: 1.0</span></div>
<div class="line"><span class="comment">// - Copyright: Copyright 2022, Jon Webb Inc.</span></div>
<div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// Include modules here</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef DENSE_MATRIX_HPP</span></div>
<div class="line"><span class="preprocessor">#define DENSE_MATRIX_HPP</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef __AVX2__</span></div>
<div class="line"><span class="preprocessor">        #include &lt;immintrin.h&gt;</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_FLOAT 8</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_DOUBLE 4</span></div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line"><span class="preprocessor">        #include &lt;emmintrin.h&gt;</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_FLOAT 4</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_DOUBLE 2</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_FLOAT 1</span></div>
<div class="line"><span class="preprocessor">        #define SIMD_WIDTH_DOUBLE 1</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">namespace </span><a class="code" href="namespaceslt.html">slt</a> {</div>
<div class="line">        <span class="comment">// SIMD traits</span></div>
<div class="line">        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">        <span class="keyword">struct </span>simd_traits {</div>
<div class="line">            <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a name="a1"></a><a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">supported</a> = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keyword">static</span> constexpr std::size_t <a name="a2"></a><a class="code" href="structslt_1_1simd__traits.html#a4d27bcf5a07aeaa4ee8af03ce93ee830">width</a> = 1;</div>
<div class="line">        };</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;&gt;</div>
<div class="line">        <span class="keyword">struct </span>simd_traits&lt;float&gt; {</div>
<div class="line">            <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">supported</a> = <a name="a3"></a><a class="code" href="matrix_8hpp.html#ac5a637320d99ebb9eaa016046afb1462">SIMD_WIDTH_FLOAT</a> &gt; 1;</div>
<div class="line">            <span class="keyword">static</span> constexpr std::size_t <a class="code" href="structslt_1_1simd__traits.html#a4d27bcf5a07aeaa4ee8af03ce93ee830">width</a> = <a class="code" href="matrix_8hpp.html#ac5a637320d99ebb9eaa016046afb1462">SIMD_WIDTH_FLOAT</a>;</div>
<div class="line">        };</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;&gt;</div>
<div class="line">        <span class="keyword">struct </span>simd_traits&lt;double&gt; {</div>
<div class="line">            <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">supported</a> = <a name="a4"></a><a class="code" href="matrix_8hpp.html#aeda68842866e63a7a2cbcd69ac99a1ba">SIMD_WIDTH_DOUBLE</a> &gt; 1;</div>
<div class="line">            <span class="keyword">static</span> constexpr std::size_t <a class="code" href="structslt_1_1simd__traits.html#a4d27bcf5a07aeaa4ee8af03ce93ee830">width</a> = <a class="code" href="matrix_8hpp.html#aeda68842866e63a7a2cbcd69ac99a1ba">SIMD_WIDTH_DOUBLE</a>;</div>
<div class="line">        };</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// SIMD operations</span></div>
<div class="line">        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">struct </span>simd_ops;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line">       </div>
<div class="line">        <span class="keyword">template</span>&lt;&gt;</div>
<div class="line">        <span class="keyword">struct </span>simd_ops&lt;float&gt; {</div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> add(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keyword">const</span> <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vb = _mm256_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m256 vr = _mm256_add_ps(va, vb);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vb = _mm_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m128 vr = _mm_add_ps(va, vb);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] + b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> sub(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keyword">const</span> <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vb = _mm256_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m256 vr = _mm256_sub_ps(va, vb);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vb = _mm_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m128 vr = _mm_sub_ps(va, vb);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] - b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> add_scalar(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keywordtype">float</span> scalar, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256 vscalar = _mm256_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vr = _mm256_add_ps(va, vscalar);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128 vscalar = _mm_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vr = _mm_add_ps(va, vscalar);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] + scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> sub_scalar(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keywordtype">float</span> scalar, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256 vscalar = _mm256_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vr = _mm256_sub_ps(va, vscalar);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128 vscalar = _mm_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vr = _mm_sub_ps(va, vscalar);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] - scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> mul(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keyword">const</span> <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vb = _mm256_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m256 vr = _mm256_mul_ps(va, vb);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vb = _mm_loadu_ps(&amp;b[i]);</div>
<div class="line">                    __m128 vr = _mm_mul_ps(va, vb);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] * b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> mul_scalar(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keywordtype">float</span> scalar, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256 vscalar = _mm256_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vr = _mm256_mul_ps(va, vscalar);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128 vscalar = _mm_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vr = _mm_mul_ps(va, vscalar);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] * scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> div_scalar(<span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keywordtype">float</span> scalar, <span class="keywordtype">float</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256 vscalar = _mm256_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 va = _mm256_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m256 vr = _mm256_div_ps(va, vscalar);</div>
<div class="line">                    _mm256_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128 vscalar = _mm_set1_ps(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 va = _mm_loadu_ps(&amp;a[i]);</div>
<div class="line">                    __m128 vr = _mm_div_ps(va, vscalar);</div>
<div class="line">                    _mm_storeu_ps(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] / scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> copy(<span class="keyword">const</span> <span class="keywordtype">float</span>* src, <span class="keywordtype">float</span>* dst, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 8 * 8;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 8) {</div>
<div class="line">                    __m256 v = _mm256_loadu_ps(&amp;src[i]);</div>
<div class="line">                    _mm256_storeu_ps(&amp;dst[i], v);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m128 v = _mm_loadu_ps(&amp;src[i]);</div>
<div class="line">                    _mm_storeu_ps(&amp;dst[i], v);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    dst[i] = src[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        };</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;&gt;</div>
<div class="line">        <span class="keyword">struct </span>simd_ops&lt;double&gt; {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> add(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keyword">const</span> <span class="keywordtype">double</span>* b, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vb = _mm256_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m256d vr = _mm256_add_pd(va, vb);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vb = _mm_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m128d vr = _mm_add_pd(va, vb);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] + b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> sub(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keyword">const</span> <span class="keywordtype">double</span>* b, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vb = _mm256_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m256d vr = _mm256_sub_pd(va, vb);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vb = _mm_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m128d vr = _mm_sub_pd(va, vb);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] - b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> add_scalar(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keywordtype">double</span> scalar, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256d vscalar = _mm256_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vr = _mm256_add_pd(va, vscalar);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128d vscalar = _mm_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vr = _mm_add_pd(va, vscalar);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] + scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> sub_scalar(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keywordtype">double</span> scalar, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256d vscalar = _mm256_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vr = _mm256_sub_pd(va, vscalar);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128d vscalar = _mm_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vr = _mm_sub_pd(va, vscalar);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] - scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> mul(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keyword">const</span> <span class="keywordtype">double</span>* b, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vb = _mm256_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m256d vr = _mm256_mul_pd(va, vb);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vb = _mm_loadu_pd(&amp;b[i]);</div>
<div class="line">                    __m128d vr = _mm_mul_pd(va, vb);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] * b[i];</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> mul_scalar(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keywordtype">double</span> scalar, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256d vscalar = _mm256_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vr = _mm256_mul_pd(va, vscalar);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128d vscalar = _mm_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vr = _mm_mul_pd(va, vscalar);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] * scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> div_scalar(<span class="keyword">const</span> <span class="keywordtype">double</span>* a, <span class="keywordtype">double</span> scalar, <span class="keywordtype">double</span>* result, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                __m256d vscalar = _mm256_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d va = _mm256_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m256d vr = _mm256_div_pd(va, vscalar);</div>
<div class="line">                    _mm256_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                __m128d vscalar = _mm_set1_pd(scalar);</div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d va = _mm_loadu_pd(&amp;a[i]);</div>
<div class="line">                    __m128d vr = _mm_div_pd(va, vscalar);</div>
<div class="line">                    _mm_storeu_pd(&amp;result[i], vr);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    result[i] = a[i] / scalar;</div>
<div class="line">            }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">            <span class="keyword">static</span> <span class="keywordtype">void</span> copy(<span class="keyword">const</span> <span class="keywordtype">double</span>* src, <span class="keywordtype">double</span>* dst, std::size_t size) {</div>
<div class="line"><span class="preprocessor">#if defined(__AVX2__)</span></div>
<div class="line">                std::size_t end = size / 4 * 4;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 4) {</div>
<div class="line">                    __m256d v = _mm256_loadu_pd(&amp;src[i]);</div>
<div class="line">                    _mm256_storeu_pd(&amp;dst[i], v);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line">                std::size_t end = size / 2 * 2;</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; end; i += 2) {</div>
<div class="line">                    __m128d v = _mm_loadu_pd(&amp;src[i]);</div>
<div class="line">                    _mm_storeu_pd(&amp;dst[i], v);</div>
<div class="line">                }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">                std::size_t end = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = end; i &lt; size; ++i)</div>
<div class="line">                    dst[i] = src[i];</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">class </span>MatrixBase {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">virtual</span> <a name="a5"></a><a class="code" href="classslt_1_1MatrixBase.html#a3bbb4cd026c2c1da1ba0881c918630b1">~MatrixBase</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> std::size_t <a name="a6"></a><a class="code" href="classslt_1_1MatrixBase.html#af5247088bf3743574e25430da458ff46">rows</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line">    </div>
<div class="line">        <span class="keyword">virtual</span> std::size_t <a name="a7"></a><a class="code" href="classslt_1_1MatrixBase.html#acee40c97e44474a9619b808b63d1868b">cols</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> T <a name="a8"></a><a class="code" href="classslt_1_1MatrixBase.html#a5fe460dc2d97ee440c32635d5f3192fc">get</a>(std::size_t row, std::size_t col) <span class="keyword">const</span> = 0;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a name="a9"></a><a class="code" href="classslt_1_1MatrixBase.html#a2925cbdba8ec46c258f8d8e1fb1b730d">set</a>(std::size_t row, std::size_t col, T value) = 0;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> std::unique_ptr&lt;MatrixBase&lt;T&gt;&gt; <a name="a10"></a><a class="code" href="classslt_1_1MatrixBase.html#a10ca9a5de506b53de715596507c77321">clone</a>() <span class="keyword">const</span> = 0;</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a name="a11"></a><a class="code" href="classslt_1_1MatrixBase.html#a069249b28295c9776df81efed6076589">is_initialized</a>(std::size_t row, std::size_t col) <span class="keyword">const</span> = 0;</div>
<div class="line">    };</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line">    <span class="comment">// Dense matrix class</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">class </span>DenseMatrix : <span class="keyword">public</span> MatrixBase&lt;T&gt; {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;,</div>
<div class="line">                      <span class="stringliteral">&quot;DenseMatrix only supports float or double&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">        std::vector&lt;T&gt; <a name="a12"></a><a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a> = <span class="keyword">nullptr</span>; </div>
<div class="line">        std::vector&lt;uint8_t&gt; <a name="a13"></a><a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a> = <span class="keyword">nullptr</span>; </div>
<div class="line">        std::size_t <a name="a14"></a><a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> = 0; </div>
<div class="line">        std::size_t <a name="a15"></a><a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> = 0; </div>
<div class="line">    <span class="comment">// ================================================================================ </span></div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        std::size_t <a name="a16"></a><a class="code" href="classslt_1_1DenseMatrix.html#a02b7df353b3562388432f1bbbb8bab54">size</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>;}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> T* <a name="a17"></a><a class="code" href="classslt_1_1DenseMatrix.html#a529848163b44a2168460198adda171f7">data_ptr</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data();}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        T* <a class="code" href="classslt_1_1DenseMatrix.html#a529848163b44a2168460198adda171f7">data_ptr</a>() {<span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data();}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> uint8_t* <a name="a18"></a><a class="code" href="classslt_1_1DenseMatrix.html#a631142d8a7cbb38a6e8210569e8605d4">init_ptr</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.data();}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        std::size_t <a name="a19"></a><a class="code" href="classslt_1_1DenseMatrix.html#a33d3181181df8997b1f81135ba6fe1d2">nonzero_count</a>()<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.empty()) <span class="keywordflow">return</span> 0;</div>
<div class="line">            <span class="keywordflow">return</span> std::count(<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.begin(), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.end(), <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(1));</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a name="a20"></a><a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(std::size_t r, std::size_t c, T value)</div>
<div class="line">            : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(r * c, value), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(r * c, 1), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(r), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(c) {}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(std::size_t r, std::size_t c)</div>
<div class="line">            : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(r * c, 0), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(r * c, 0), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(r), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(c) {}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(<span class="keyword">const</span> std::vector&lt;std::vector&lt;T&gt;&gt;&amp; vec) {</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> = vec.size();</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> = <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> ? vec[0].size() : 0;</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.resize(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.resize(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>, 1);</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>; ++i) {</div>
<div class="line">                <span class="keywordflow">if</span> (vec[i].<a class="code" href="classslt_1_1DenseMatrix.html#a02b7df353b3562388432f1bbbb8bab54">size</a>() != <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;All rows must have the same number of columns&quot;</span>);</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>; ++j)</div>
<div class="line">                    <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + j] = vec[i][j];</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> Rows, std::<span class="keywordtype">size_t</span> Cols&gt;</div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(<span class="keyword">const</span> std::array&lt;std::array&lt;T, Cols&gt;, Rows&gt;&amp; arr)</div>
<div class="line">            : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(Rows * Cols), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(Rows * Cols, 1), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(Rows), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(Cols) {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; Rows; ++i)</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; Cols; ++j)</div>
<div class="line">                    <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i * Cols + j] = arr[i][j];</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(std::initializer_list&lt;std::initializer_list&lt;T&gt;&gt; init_list) {</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> = init_list.size();</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> = <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> ? init_list.begin()-&gt;size() : 0;</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.reserve(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.reserve(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; row : init_list) {</div>
<div class="line">                <span class="keywordflow">if</span> (row.size() != <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;All rows must have the same number of columns&quot;</span>);</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.insert(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.end(), row.begin(), row.end());</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.insert(<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>.end(), row.size(), 1);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; flat_data, std::size_t r, std::size_t c)</div>
<div class="line">            : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(flat_data), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(flat_data.size(), 1), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(r), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(c) {</div>
<div class="line">            <span class="keywordflow">if</span> (flat_data.size() != r * c)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Flat data size does not match matrix dimensions&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> N&gt;</div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(<span class="keyword">const</span> std::array&lt;T, N&gt;&amp; arr, std::size_t r, std::size_t c)</div>
<div class="line">            : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(arr.begin(), arr.end()), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(N, 1), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(r), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(c) {</div>
<div class="line">            <span class="keywordflow">if</span> (N != r * c)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Flat array size does not match matrix dimensions&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --------------------------------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(<span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; other)</div>
<div class="line">            : MatrixBase&lt;T&gt;(),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(other.data),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(other.init),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(other.rows_),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(other.cols_) {}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(DenseMatrix&lt;T&gt;&amp;&amp; other) noexcept</div>
<div class="line">            : MatrixBase&lt;T&gt;(),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(std::move(other.data)),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(std::move(other.init)),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(std::exchange(other.rows_, 0)),</div>
<div class="line">              <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(std::exchange(other.cols_, 0)) {}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">explicit</span> <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>(std::size_t n) : <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>(n * n, 0), <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>(n * n, 0), <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>(n), <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>(n) {</div>
<div class="line">            <span class="keywordflow">if</span> (n == 0)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Size of identity matrix must be greater than zero&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; n; ++i) {</div>
<div class="line">                std::size_t idx = i * n + i;</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx] = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1);</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx] = 1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        T&amp; <a name="a21"></a><a class="code" href="classslt_1_1DenseMatrix.html#a77c081ccac829706e7b345faf2acf42d">operator()</a>(std::size_t r, std::size_t c) {</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || c &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Matrix index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            std::size_t idx = r * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + c;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// If value is not initialized, we assume this is the first assignment</span></div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx])</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx] = 1;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx];</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> T&amp; <a class="code" href="classslt_1_1DenseMatrix.html#a77c081ccac829706e7b345faf2acf42d">operator()</a>(std::size_t r, std::size_t c)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || c &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Matrix index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            std::size_t idx = r * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + c;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx])</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempted to access uninitialized matrix value&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx];</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt;&amp; <a name="a22"></a><a class="code" href="classslt_1_1DenseMatrix.html#a4f16ef2fe485bfeaff37e07be5cbb437">operator=</a>(<span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; other) {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;other) {</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a> = other.data;</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a> = other.init;</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> = other.rows_;</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> = other.cols_;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt;&amp; <a class="code" href="classslt_1_1DenseMatrix.html#a4f16ef2fe485bfeaff37e07be5cbb437">operator=</a>(DenseMatrix&lt;T&gt;&amp;&amp; other) noexcept {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;other) {</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a> = std::move(other.data);</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a> = std::move(other.init);</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> = std::exchange(other.rows_, 0);</div>
<div class="line">                <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> = std::exchange(other.cols_, 0);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a name="a23"></a><a class="code" href="classslt_1_1DenseMatrix.html#a01bfb57f1f4c7f11110926bd3625834a">operator+</a>(<span class="keyword">const</span> <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for addition&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::add(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), other.data.data(), result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);  <span class="comment">//  this line is crucial</span></div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] + other.data[i];</div>
<div class="line">                    result.init[i] = 1;  <span class="comment">//  also crucial</span></div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a class="code" href="classslt_1_1DenseMatrix.html#a01bfb57f1f4c7f11110926bd3625834a">operator+</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::add_scalar(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), scalar, result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] + scalar;</div>
<div class="line">                    result.init[i] = 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a name="a24"></a><a class="code" href="classslt_1_1DenseMatrix.html#a64a5482eb0dbba6aa16825fda6eac2ac">operator-</a>(<span class="keyword">const</span> <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for subtraction&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::sub(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), other.data.data(), result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);  <span class="comment">// Mark all entries as initialized</span></div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] - other.data[i];</div>
<div class="line">                    result.init[i] = 1;  <span class="comment">// Mark entry as initialized</span></div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a class="code" href="classslt_1_1DenseMatrix.html#a64a5482eb0dbba6aa16825fda6eac2ac">operator-</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::sub_scalar(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), scalar, result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);  <span class="comment">// Mark as initialized</span></div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] - scalar;</div>
<div class="line">                    result.init[i] = 1;  <span class="comment">// Mark each element as initialized</span></div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a name="a25"></a><a class="code" href="classslt_1_1DenseMatrix.html#ab28b2210e92edcb57fb8d042e185571f">operator*</a>(<span class="keyword">const</span> <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for element-wise multiplication&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::mul(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), other.data.data(), result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] * other.data[i];</div>
<div class="line">                    result.init[i] = 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a class="code" href="classslt_1_1DenseMatrix.html#ab28b2210e92edcb57fb8d042e185571f">operator*</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::mul_scalar(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), scalar, result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] * scalar;</div>
<div class="line">                    result.init[i] = 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> <a name="a26"></a><a class="code" href="classslt_1_1DenseMatrix.html#a36182695820d97a3e651f6cdb93faf0a">operator/</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (scalar == T{}) <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Division by zero&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">DenseMatrix</a> result(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">            <span class="keywordflow">if</span> constexpr (<a class="code" href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">simd_traits&lt;T&gt;::supported</a>) {</div>
<div class="line">                simd_ops&lt;T&gt;::div_scalar(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.data(), scalar, result.data.data(), <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">                std::fill(result.init.begin(), result.init.end(), 1);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size(); ++i) {</div>
<div class="line">                    result.data[i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i] / scalar;</div>
<div class="line">                    result.init[i] = 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a27"></a><a class="code" href="classslt_1_1DenseMatrix.html#a09a6958aa43a7ead237b48114527ef5b">transpose</a>() {</div>
<div class="line">            std::vector&lt;T&gt; new_data(<a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.size());</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>; ++i) {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>; ++j) {</div>
<div class="line">                    new_data[j * <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> + i] = <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[i * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + j];</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>.swap(new_data);</div>
<div class="line">            std::swap(<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>, <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; <a name="a28"></a><a class="code" href="classslt_1_1DenseMatrix.html#ae7443b52dd5c9229b1e57836c62734e5">inverse</a>()<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> != <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Only square matrices can be inverted&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::size_t n = <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>;</div>
<div class="line">            DenseMatrix&lt;T&gt; A(*<span class="keyword">this</span>);</div>
<div class="line">            DenseMatrix&lt;T&gt; I(n, n, T{});</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; n; ++i)</div>
<div class="line">                I.update(i, i, T{1});  <span class="comment">// Identity matrix</span></div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; n; ++i) {</div>
<div class="line">                <span class="comment">// Pivot selection (partial pivoting)</span></div>
<div class="line">                std::size_t pivot = i;</div>
<div class="line">                T max_val = std::abs(A.get(i, i));</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = i + 1; j &lt; n; ++j) {</div>
<div class="line">                    T val = std::abs(A.get(j, i));</div>
<div class="line">                    <span class="keywordflow">if</span> (val &gt; max_val) {</div>
<div class="line">                        max_val = val;</div>
<div class="line">                        pivot = j;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (max_val == T{})</div>
<div class="line">                    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Matrix is singular and cannot be inverted&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Swap rows (corrected)</span></div>
<div class="line">                <span class="keywordflow">if</span> (pivot != i) {</div>
<div class="line">                    <span class="keywordflow">for</span> (std::size_t k = 0; k &lt; n; ++k) {</div>
<div class="line">                        std::swap(A.data[i * n + k], A.data[pivot * n + k]);</div>
<div class="line">                        std::swap(A.init[i * n + k], A.init[pivot * n + k]);</div>
<div class="line">                        std::swap(I.data[i * n + k], I.data[pivot * n + k]);</div>
<div class="line">                        std::swap(I.init[i * n + k], I.init[pivot * n + k]);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Normalize pivot row</span></div>
<div class="line">                T pivot_val = A.data[i * n + i];</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t k = 0; k &lt; n; ++k) {</div>
<div class="line">                    A.data[i * n + k] /= pivot_val;</div>
<div class="line">                    A.init[i * n + k] = 1;</div>
<div class="line"> </div>
<div class="line">                    I.data[i * n + k] /= pivot_val;</div>
<div class="line">                    I.init[i * n + k] = 1;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Eliminate other rows</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; n; ++j) {</div>
<div class="line">                    <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line">                    T factor = A.data[j * n + i];</div>
<div class="line">                    <span class="keywordflow">for</span> (std::size_t k = 0; k &lt; n; ++k) {</div>
<div class="line">                        A.data[j * n + k] -= factor * A.data[i * n + k];</div>
<div class="line">                        A.init[j * n + k] = 1;</div>
<div class="line"> </div>
<div class="line">                        I.data[j * n + k] -= factor * I.data[i * n + k];</div>
<div class="line">                        I.init[j * n + k] = 1;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> I;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        std::size_t <a name="a29"></a><a class="code" href="classslt_1_1DenseMatrix.html#ae6666df109b2705e298cae85028014b6">rows</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>; }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        std::size_t <a name="a30"></a><a class="code" href="classslt_1_1DenseMatrix.html#ac182317252d8e104ea9be539358fe1b2">cols</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>; }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        T <a name="a31"></a><a class="code" href="classslt_1_1DenseMatrix.html#a64113fe72d74abc3e8f957e5f0bbee9e">get</a>(std::size_t row, std::size_t col)<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || col &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of range&quot;</span>);</div>
<div class="line">            </div>
<div class="line">            std::size_t idx = row * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + col;</div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx])</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Accessing uninitialized matrix element&quot;</span>);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx];</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a32"></a><a class="code" href="classslt_1_1DenseMatrix.html#a06b7efc75ec0ecfa24c628b422f73f53">set</a>(std::size_t row, std::size_t col, T value)<span class="keyword"> override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || col &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of range&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            std::size_t idx = row * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + col;</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx])</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cannot set value: element already initialized. Use update instead.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx] = value;</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx] = 1;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a33"></a><a class="code" href="classslt_1_1DenseMatrix.html#ae55af06b38c452c75279bbfe4d0abaf4">remove</a>(std::size_t row, std::size_t col) {</div>
<div class="line">            <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || col &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of range&quot;</span>);</div>
<div class="line">            std::size_t idx = row * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + col;</div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx]) </div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cannot remove value: element not initialized.&quot;</span>);</div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[idx] = T{0};      <span class="comment">// Reset value</span></div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[idx] = 0;         <span class="comment">// Mark uninitialized</span></div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a34"></a><a class="code" href="classslt_1_1DenseMatrix.html#aa051172f51cb694e62d2ac92212e2b42">update</a>(std::size_t row, std::size_t col, T value) {</div>
<div class="line">            <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || col &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Update failed: index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            std::size_t index = row * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + col;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[index] == 0)</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Update failed: value not initialized&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">data</a>[index] = value;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        std::unique_ptr&lt;MatrixBase&lt;T&gt;&gt; <a name="a35"></a><a class="code" href="classslt_1_1DenseMatrix.html#a66bf4b77281db6ded265fc44f8b3a309">clone</a>()<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">return</span> std::make_unique&lt;DenseMatrix&gt;(*<span class="keyword">this</span>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a36"></a><a class="code" href="classslt_1_1DenseMatrix.html#a0439627319cdaed291451c4135c33c2b">print</a>(std::ostream&amp; os = std::cout)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a>; ++i) {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>; ++j) {</div>
<div class="line">                    os &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="classslt_1_1DenseMatrix.html#a77c081ccac829706e7b345faf2acf42d">operator()</a>(i, j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">bool</span> <a name="a37"></a><a class="code" href="classslt_1_1DenseMatrix.html#aecc5061bed3861b391292058e43ae1b2">is_initialized</a>(std::size_t row, std::size_t col)<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (row &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">rows_</a> || col &gt;= <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of range&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">init</a>[row * <a class="code" href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">cols_</a> + col] != 0;</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    std::ostream&amp; <a name="a38"></a><a class="code" href="namespaceslt.html#adbc6a9912aba420a4fe67ba6abd729a9">operator&lt;&lt;</a>(std::ostream&amp; os, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; mat) {</div>
<div class="line">        mat.print(os);</div>
<div class="line">        <span class="keywordflow">return</span> os;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a name="a39"></a><a class="code" href="namespaceslt.html#ae726d568aa0e281c4bd86d71f337b8c4">operator+</a>(T scalar, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; matrix) {</div>
<div class="line">        <span class="keywordflow">return</span> matrix + scalar;  <span class="comment">// Leverage existing member operator+</span></div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <a name="_a40"></a><a class="code" href="classslt_1_1DenseMatrix.html">slt::DenseMatrix&lt;T&gt;</a> <a name="a41"></a><a class="code" href="namespaceslt.html#ab7a55d8c976eb591ad233a83bffc43ce">operator-</a>(T scalar, <span class="keyword">const</span> <a class="code" href="classslt_1_1DenseMatrix.html">slt::DenseMatrix&lt;T&gt;</a>&amp; matrix) {</div>
<div class="line">        <a class="code" href="classslt_1_1DenseMatrix.html">slt::DenseMatrix&lt;T&gt;</a> result(matrix.<a class="code" href="classslt_1_1DenseMatrix.html#ae6666df109b2705e298cae85028014b6">rows</a>(), matrix.<a class="code" href="classslt_1_1DenseMatrix.html#ac182317252d8e104ea9be539358fe1b2">cols</a>());</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; matrix.<a class="code" href="classslt_1_1DenseMatrix.html#ae6666df109b2705e298cae85028014b6">rows</a>(); ++i) {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; matrix.<a class="code" href="classslt_1_1DenseMatrix.html#ac182317252d8e104ea9be539358fe1b2">cols</a>(); ++j) {</div>
<div class="line">                <span class="keywordflow">if</span> (matrix.<a class="code" href="classslt_1_1DenseMatrix.html#aecc5061bed3861b391292058e43ae1b2">is_initialized</a>(i, j)) {</div>
<div class="line">                    result.<a class="code" href="classslt_1_1DenseMatrix.html#a06b7efc75ec0ecfa24c628b422f73f53">set</a>(i, j, scalar - matrix.<a class="code" href="classslt_1_1DenseMatrix.html#a64113fe72d74abc3e8f957e5f0bbee9e">get</a>(i, j));</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">// If not initialized, skipresult stays uninitialized</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a name="a42"></a><a class="code" href="namespaceslt.html#a7a4f1a42d7dfbc00af75ce9cb1ec6d8b">operator*</a>(T scalar, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; matrix) {</div>
<div class="line">        <span class="keywordflow">return</span> matrix * scalar;  <span class="comment">// Leverage member function</span></div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    T <a name="a43"></a><a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(<span class="keyword">const</span> T* a, <span class="keyword">const</span> T* b, std::size_t size) {</div>
<div class="line">        static_assert(std::is_same&lt;T, float&gt;::value || std::is_same&lt;T, double&gt;::value,</div>
<div class="line">                      <span class="stringliteral">&quot;dot&lt;T&gt;: only float and double are supported&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!a || !b) <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Null pointer passed to dot product&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;T&gt; temp(size);</div>
<div class="line">        simd_ops&lt;T&gt;::mul(a, b, temp.data(), size);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Reduce result (scalar fallback)</span></div>
<div class="line">        T sum = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0);</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; size; ++i)</div>
<div class="line">            sum += temp[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> sum;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2. std::vector overload</span></div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    T <a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; a, <span class="keyword">const</span> std::vector&lt;T&gt;&amp; b) {</div>
<div class="line">        <span class="keywordflow">if</span> (a.size() != b.size())</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Vector sizes must match for dot product.&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(a.data(), b.data(), a.size());</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3. std::array overload</span></div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, std::<span class="keywordtype">size_t</span> N&gt;</div>
<div class="line">    T <a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(<span class="keyword">const</span> std::array&lt;T, N&gt;&amp; a, <span class="keyword">const</span> std::array&lt;T, N&gt;&amp; b) {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(a.data(), b.data(), N);</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a name="a44"></a><a class="code" href="namespaceslt.html#a4a91f90ca1405d694326b5ec7e8d3be7">cross</a>(<span class="keyword">const</span> T* a, <span class="keyword">const</span> T* b, T* result) {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;, <span class="stringliteral">&quot;T must be float or double&quot;</span>);</div>
<div class="line">        assert(a &amp;&amp; b &amp;&amp; result);</div>
<div class="line"> </div>
<div class="line">        result[0] = a[1] * b[2] - a[2] * b[1];</div>
<div class="line">        result[1] = a[2] * b[0] - a[0] * b[2];</div>
<div class="line">        result[2] = a[0] * b[1] - a[1] * b[0];</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">inline</span> std::array&lt;T, 3&gt; <a class="code" href="namespaceslt.html#a4a91f90ca1405d694326b5ec7e8d3be7">cross</a>(<span class="keyword">const</span> std::array&lt;T, 3&gt;&amp; a, <span class="keyword">const</span> std::array&lt;T, 3&gt;&amp; b) {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;, <span class="stringliteral">&quot;T must be float or double&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> {</div>
<div class="line">            a[1] * b[2] - a[2] * b[1],</div>
<div class="line">            a[2] * b[0] - a[0] * b[2],</div>
<div class="line">            a[0] * b[1] - a[1] * b[0]</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">inline</span> std::vector&lt;T&gt; <a class="code" href="namespaceslt.html#a4a91f90ca1405d694326b5ec7e8d3be7">cross</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; a, <span class="keyword">const</span> std::vector&lt;T&gt;&amp; b) {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;, <span class="stringliteral">&quot;T must be float or double&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        assert(a.size() == 3 &amp;&amp; b.size() == 3);</div>
<div class="line">        <span class="keywordflow">return</span> {</div>
<div class="line">            a[1] * b[2] - a[2] * b[1],</div>
<div class="line">            a[2] * b[0] - a[0] * b[2],</div>
<div class="line">            a[0] * b[1] - a[1] * b[0]</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a name="a45"></a><a class="code" href="namespaceslt.html#a65e705fbd81f19d98c1fcf81ef098e2c">mat_mul</a>(<span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; A, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; B) {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;,</div>
<div class="line">                      <span class="stringliteral">&quot;mat_mul only supports float or double types.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::size_t A_rows = A.rows();</div>
<div class="line">        <span class="keyword">const</span> std::size_t A_cols = A.cols();</div>
<div class="line">        <span class="keyword">const</span> std::size_t B_rows = B.rows();</div>
<div class="line">        <span class="keyword">const</span> std::size_t B_cols = B.cols();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (A_cols != B_rows) {</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions are incompatible for multiplication.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; result(A_rows, B_cols);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; A_rows; ++i) {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; B_cols; ++j) {</div>
<div class="line">                <span class="comment">// Extract row i of A and column j of B</span></div>
<div class="line">                std::vector&lt;T&gt; row(A_cols);</div>
<div class="line">                std::vector&lt;T&gt; col(A_cols);</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t k = 0; k &lt; A_cols; ++k) {</div>
<div class="line">                    row[k] = A.get(i, k);</div>
<div class="line">                    col[k] = B.get(k, j);</div>
<div class="line">                }</div>
<div class="line">                result.set(i, j, <a class="code" href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">dot</a>(row, col));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    <span class="keyword">class </span>SparseCOOMatrix : <span class="keyword">public</span> MatrixBase&lt;T&gt; {</div>
<div class="line">        static_assert(std::is_same_v&lt;T, float&gt; || std::is_same_v&lt;T, double&gt;,</div>
<div class="line">                      <span class="stringliteral">&quot;DenseMatrix only supports float or double&quot;</span>);</div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">        std::vector&lt;T&gt; <a name="a46"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>; </div>
<div class="line">        std::size_t <a name="a47"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>, <a name="a48"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>; </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// COO Specific data</span></div>
<div class="line">        std::vector&lt;std::size_t&gt; <a name="a49"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>; </div>
<div class="line">        std::vector&lt;std::size_t&gt; <a name="a50"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>; </div>
<div class="line">        <span class="keywordtype">bool</span> <a name="a51"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a> = <span class="keyword">true</span>;  </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Comparator for sorting and binary search</span></div>
<div class="line">        <span class="keyword">struct </span>COOComparator {</div>
<div class="line">            <span class="keywordtype">bool</span> <a name="a52"></a><a class="code" href="structslt_1_1SparseCOOMatrix_1_1COOComparator.html#a443e01d2641ec82d3430c70cfa9647bf">operator()</a>(std::pair&lt;std::size_t, std::size_t&gt; a,</div>
<div class="line">                            std::pair&lt;std::size_t, std::size_t&gt; b)<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> a.first &lt; b.first || (a.first == b.first &amp;&amp; a.second &lt; b.second);</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        std::size_t <a name="a53"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a5bc2a8f7766afa09ceaf18d83447875f">size</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> * <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>;}  </div>
<div class="line">        std::size_t <a name="a54"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#aeffd4e5b6e6d980855f1dc31d964188b">nonzero_count</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size();}  </div>
<div class="line">        std::size_t <a name="a55"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a26f9d4289054f90dc5248edee3385f2d">row_index</a>(std::size_t i)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.size()) <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Row index out of range&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        std::size_t <a name="a56"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a0d82d6bb156ed5dbb372bb7c8155b7d5">col_index</a>(std::size_t i)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>.size()) <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Column index out of range&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        T <a name="a57"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>(std::size_t i)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size()) <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Value index out of range&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i];</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">explicit</span> <a name="a58"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(std::size_t r, std::size_t c, <span class="keywordtype">bool</span> fastInsert = <span class="keyword">true</span>)</div>
<div class="line">            : <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(r), <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(c), <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(fastInsert) {</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.reserve(8);</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>.reserve(8);</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.reserve(8);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(<span class="keyword">const</span> std::vector&lt;std::vector&lt;T&gt;&gt;&amp; vec, <span class="keywordtype">bool</span> fastInsert = <span class="keyword">true</span>)</div>
<div class="line">            : <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(vec.size()), <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(vec.empty() ? 0 : vec[0].size()), <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(fastInsert) {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>; ++i) {</div>
<div class="line">                <span class="keywordflow">if</span> (vec[i].<a class="code" href="classslt_1_1SparseCOOMatrix.html#a5bc2a8f7766afa09ceaf18d83447875f">size</a>() != <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>)</div>
<div class="line">                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;All rows must have the same number of columns&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>; ++j) {</div>
<div class="line">                    <span class="keywordflow">if</span> (vec[i][j] != T{})  <span class="comment">// Skip zeros</span></div>
<div class="line">                        this-&gt;<a name="a59"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">set</a>(i, j, vec[i][j]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">template</span>&lt;std::<span class="keywordtype">size_t</span> Rows, std::<span class="keywordtype">size_t</span> Cols&gt;</div>
<div class="line">        <span class="keyword">explicit</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(<span class="keyword">const</span> std::array&lt;std::array&lt;T, Cols&gt;, Rows&gt;&amp; arr, <span class="keywordtype">bool</span> fastInsert = <span class="keyword">true</span>)</div>
<div class="line">            : <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(Rows), <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(Cols), <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(fastInsert) {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; Rows; ++i) {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; Cols; ++j) {</div>
<div class="line">                    <span class="keywordflow">if</span> (arr[i][j] != T{})  <span class="comment">// Skip zeros</span></div>
<div class="line">                        this-&gt;<a class="code" href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">set</a>(i, j, arr[i][j]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(std::initializer_list&lt;std::initializer_list&lt;T&gt;&gt; initList, <span class="keywordtype">bool</span> fastInsert = <span class="keyword">true</span>)</div>
<div class="line">            : <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(initList.size()), <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(initList.begin()-&gt;size()), <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(fastInsert) {</div>
<div class="line">            std::size_t i = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rowList : initList) {</div>
<div class="line">                <span class="keywordflow">if</span> (rowList.size() != <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>)</div>
<div class="line">                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;All rows must have the same number of columns&quot;</span>);</div>
<div class="line">                std::size_t j = 0;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">const</span> T&amp; val : rowList) {</div>
<div class="line">                    <span class="keywordflow">if</span> (val != T{})</div>
<div class="line">                        this-&gt;<a class="code" href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">set</a>(i, j, val);</div>
<div class="line">                    ++j;</div>
<div class="line">                }</div>
<div class="line">                ++i;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; flat_data, std::size_t r, std::size_t c, <span class="keywordtype">bool</span> fastInsert = <span class="keyword">true</span>)</div>
<div class="line">            : <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(r), <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(c), <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(fastInsert) {</div>
<div class="line">            <span class="keywordflow">if</span> (flat_data.size() != r * c)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Flat data size does not match matrix dimensions&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; r; ++i) {</div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t j = 0; j &lt; c; ++j) {</div>
<div class="line">                    T val = flat_data[i * c + j];</div>
<div class="line">                    <span class="keywordflow">if</span> (val != T{})</div>
<div class="line">                        this-&gt;<a class="code" href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">set</a>(i, j, val);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; other)</div>
<div class="line">            : MatrixBase&lt;T&gt;(),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>(other.data),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(other.rows_),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(other.cols_),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>(other.row),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>(other.col),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(other.fast_set){}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>(SparseCOOMatrix&lt;T&gt;&amp;&amp; other) noexcept</div>
<div class="line">            : MatrixBase&lt;T&gt;(),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>(std::move(other.data)),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>(std::exchange(other.rows_, 0)),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>(std::exchange(other.cols_, 0)),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>(std::move(other.row)),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>(std::move(other.col)),</div>
<div class="line">              <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>(std::exchange(other.fast_set, <span class="keyword">true</span>)) {}</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        T <a name="a60"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#abb078adcd4c95de5d7bddbe438a06316">operator()</a>(std::size_t r, std::size_t c)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">return</span> this-&gt;<a name="a61"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a8060856161b5989ab2f30b87d8d5bf71">get</a>(r, c);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">bool</span> <a name="a62"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a1dc02d00cac074d3771223b358de6152">operator==</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a> != other.row || <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a> != other.col || <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size() != other.data.size())</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size(); ++i) {</div>
<div class="line">                <span class="keywordflow">if</span> constexpr (std::is_floating_point_v&lt;T&gt;) {</div>
<div class="line">                    <span class="keywordflow">if</span> (std::fabs(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i] - other.data[i]) &gt; 1e-6)</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i] != other.data[i])</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        SparseCOOMatrix&lt;T&gt;&amp; <a name="a63"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a8066b8bab1b1db44570b043591547447">operator=</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; other) {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;other) {</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> = other.rows_;</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> = other.cols_;</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a> = other.fast_set;</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a> = other.row;</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a> = other.col;</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a> = other.data;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        SparseCOOMatrix&lt;T&gt;&amp; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a8066b8bab1b1db44570b043591547447">operator=</a>(SparseCOOMatrix&lt;T&gt;&amp;&amp; other) noexcept {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;other) {</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> = std::exchange(other.rows_, 0);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> = std::exchange(other.cols_, 0);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a> = std::exchange(other.fast_set, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a> = std::move(other.row);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a> = std::move(other.col);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a> = std::move(other.data);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; <a name="a64"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a92b8c482627448d29d112af92da1afb8">operator+</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for addition&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            DenseMatrix&lt;T&gt; result(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>, <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Add all elements from this sparse matrix</span></div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size(); ++i)</div>
<div class="line">                result.set(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i], <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i], <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i]);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Add all elements from the other sparse matrix</span></div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; other.data.size(); ++i) {</div>
<div class="line">                std::size_t r = other.row[i];</div>
<div class="line">                std::size_t c = other.col[i];</div>
<div class="line">                <span class="keywordflow">if</span> (result.is_initialized(r, c))</div>
<div class="line">                    result.update(r, c, result(r, c) + other.data[i]);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    result.set(r, c, other.data[i]);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a92b8c482627448d29d112af92da1afb8">operator+</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a> result(*<span class="keyword">this</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; val : result.data) {</div>
<div class="line">                val += scalar;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; <a name="a65"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a869a28d52e8cf7658dc8cc87a9bfcc6d">operator-</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> != other.cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for subtraction&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            DenseMatrix&lt;T&gt; result(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>, <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Add all elements from this sparse matrix</span></div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size(); ++i)</div>
<div class="line">                result.set(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i], <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i], <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i]);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Subtract all elements from the other sparse matrix</span></div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; other.data.size(); ++i) {</div>
<div class="line">                std::size_t r = other.row[i];</div>
<div class="line">                std::size_t c = other.col[i];</div>
<div class="line">                <span class="keywordflow">if</span> (result.is_initialized(r, c))</div>
<div class="line">                    result.update(r, c, result(r, c) - other.data[i]);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    result.set(r, c, -other.data[i]);  <span class="comment">// &lt;-- Fix: negate value</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a869a28d52e8cf7658dc8cc87a9bfcc6d">operator-</a>(T scalar)<span class="keyword"> const </span>{</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a> result(*<span class="keyword">this</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; val : result.data) {</div>
<div class="line">                val -= scalar;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a> <a name="a66"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a562d500b4202fbc2afb7123571ac6d60">operator*</a>(<span class="keyword">const</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">SparseCOOMatrix</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> != other.rows_ || <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a> != other.cols_)</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for element-wise multiplication&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        SparseCOOMatrix&lt;T&gt; result(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>, <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size(); ++i) {</div>
<div class="line">            std::size_t r = <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i];</div>
<div class="line">            std::size_t c = <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (other.is_initialized(r, c)) {</div>
<div class="line">                T product = <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i] * other.get(r, c);</div>
<div class="line">                result.set(r, c, product);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"><span class="comment"></span>        std::size_t <a name="a67"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#aa8f0e3fdab670152566ce8353a9c42fa">rows</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a>; }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        std::size_t <a name="a68"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a1ccef3397e1eeb5c9a4a1e895ff25866">cols</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>; }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        T <a class="code" href="classslt_1_1SparseCOOMatrix.html#a8060856161b5989ab2f30b87d8d5bf71">get</a>(std::size_t r, std::size_t c)<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> || c &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>) {</div>
<div class="line">                <span class="comment">// Linear search (O(n)) for unsorted data</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size(); ++i) {</div>
<div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i] == r &amp;&amp; <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i] == c)</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[i];</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Accessing uninitialized matrix element&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Binary search (O(log n)) for sorted data</span></div>
<div class="line">            std::size_t left = 0;</div>
<div class="line">            std::size_t right = <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.size();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">while</span> (left &lt; right) {</div>
<div class="line">                std::size_t mid = left + (right - left) / 2;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[mid] == r &amp;&amp; <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[mid] == c) {</div>
<div class="line">                    <span class="keywordflow">return</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[mid];</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[mid] &lt; r || (<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[mid] == r &amp;&amp; <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[mid] &lt; c)) {</div>
<div class="line">                    left = mid + 1;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    right = mid;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Accessing uninitialized matrix element&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line">    </div>
<div class="line">        std::unique_ptr&lt;MatrixBase&lt;T&gt;&gt; <a name="a69"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a532cedb759d6e7e633c4a3ad84f17c69">clone</a>()<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">return</span> std::make_unique&lt;SparseCOOMatrix&gt;(*<span class="keyword">this</span>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a class="code" href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">set</a>(std::size_t r, std::size_t c, T <a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>)<span class="keyword"> override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> || c &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">fast_set</a>) {</div>
<div class="line">                <span class="comment">// Fast insert: append without duplicate checks</span></div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.push_back(r);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>.push_back(c);</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.push_back(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Construct index pairs to search safely</span></div>
<div class="line">            std::vector&lt;std::pair&lt;std::size_t, std::size_t&gt;&gt; indices;</div>
<div class="line">            indices.reserve(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.size());</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.size(); ++i) {</div>
<div class="line">                indices.emplace_back(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[i], <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[i]);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> target = std::make_pair(r, c);</div>
<div class="line">            <span class="keyword">auto</span> it = std::lower_bound(indices.begin(), indices.end(), target);</div>
<div class="line"> </div>
<div class="line">            std::size_t index = std::distance(indices.begin(), it);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (index &lt; indices.size() &amp;&amp; indices[index] == target) {</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Value already set. Use update() instead.&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.insert(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.begin() + index, r);</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>.insert(<a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>.begin() + index, c);</div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.insert(<a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>.begin() + index, <a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>);</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a name="a70"></a><a class="code" href="classslt_1_1SparseCOOMatrix.html#a30d1204d80d8b51f20217c5af322a2da">update</a>(std::size_t r, std::size_t c, T <a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">rows_</a> || c &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">cols_</a>)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Step 1: Binary search for the index</span></div>
<div class="line">            <span class="keyword">auto</span> it = std::lower_bound(</div>
<div class="line">                <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.begin(), <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.end(),</div>
<div class="line">                std::make_pair(r, c),</div>
<div class="line">                [<span class="keyword">this</span>](<span class="keywordtype">size_t</span> i, <span class="keyword">const</span> std::pair&lt;size_t, size_t&gt;&amp; target) {</div>
<div class="line">                    return std::pair&lt;size_t, size_t&gt;{row[i], col[i]} &lt; target;</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">            std::size_t index = std::distance(<a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.begin(), it);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Step 2: Must already exist</span></div>
<div class="line">            <span class="keywordflow">if</span> (index &gt;= <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>.size() || <a class="code" href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">row</a>[index] != r || <a class="code" href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">col</a>[index] != c) {</div>
<div class="line">                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Element not set yet. Use set() first.&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">data</a>[index] = <a class="code" href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">value</a>;</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">bool</span> is_initialized(std::size_t r, std::size_t c)<span class="keyword"> const override </span>{</div>
<div class="line">            <span class="keywordflow">if</span> (r &gt;= rows_ || c &gt;= cols_)</div>
<div class="line">                <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;Index out of range&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (fast_set) {</div>
<div class="line">                <span class="comment">// Linear search for unsorted data</span></div>
<div class="line">                <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; data.size(); ++i) {</div>
<div class="line">                    <span class="keywordflow">if</span> (row[i] == r &amp;&amp; col[i] == c)</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">// Binary search for sorted data</span></div>
<div class="line">                std::size_t left = 0;</div>
<div class="line">                std::size_t right = data.size();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">while</span> (left &lt; right) {</div>
<div class="line">                    std::size_t mid = left + (right - left) / 2;</div>
<div class="line">                    <span class="keywordflow">if</span> (row[mid] == r &amp;&amp; col[mid] == c)</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (row[mid] &lt; r || (row[mid] == r &amp;&amp; col[mid] &lt; c))</div>
<div class="line">                        left = mid + 1;</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        right = mid;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> finalize() {</div>
<div class="line">            <span class="keywordflow">if</span> (!fast_set) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">            std::vector&lt;std::size_t&gt; indices(data.size());</div>
<div class="line">            std::iota(indices.begin(), indices.end(), 0);</div>
<div class="line"> </div>
<div class="line">            std::stable_sort(indices.begin(), indices.end(),</div>
<div class="line">                [<span class="keyword">this</span>](std::size_t a, std::size_t b) {</div>
<div class="line">                    return std::tie(row[a], col[a]) &lt; std::tie(row[b], col[b]);</div>
<div class="line">                });</div>
<div class="line"> </div>
<div class="line">            std::vector&lt;std::size_t&gt; sorted_row, sorted_col;</div>
<div class="line">            std::vector&lt;T&gt; sorted_data;</div>
<div class="line">            sorted_row.reserve(row.size());</div>
<div class="line">            sorted_col.reserve(col.size());</div>
<div class="line">            sorted_data.reserve(data.size());</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t idx : indices) {</div>
<div class="line">                sorted_row.push_back(row[idx]);</div>
<div class="line">                sorted_col.push_back(col[idx]);</div>
<div class="line">                sorted_data.push_back(data[idx]);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            row = std::move(sorted_row);</div>
<div class="line">            col = std::move(sorted_col);</div>
<div class="line">            data = std::move(sorted_data);</div>
<div class="line"> </div>
<div class="line">            fast_set = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment">// --------------------------------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">bool</span> set_fast()<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">return</span> fast_set;</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// SparseCOOMatrix friend functions </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    SparseCOOMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ae726d568aa0e281c4bd86d71f337b8c4">operator+</a>(T scalar, <span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; matrix) {</div>
<div class="line">        <span class="keywordflow">return</span> matrix + scalar;  <span class="comment">// Reuse member operator+</span></div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ae726d568aa0e281c4bd86d71f337b8c4">operator+</a>(<span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; dense, <span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; sparse) {</div>
<div class="line">        <span class="keywordflow">if</span> (dense.rows() != sparse.rows() || dense.cols() != sparse.cols())</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for addition&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; result(dense.rows(), dense.cols());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Copy dense matrix data to result</span></div>
<div class="line">        <span class="keywordflow">if</span> constexpr (simd_traits&lt;T&gt;::supported) {</div>
<div class="line">            simd_ops&lt;T&gt;::copy(dense.data_ptr(), result.data_ptr(), dense.size());</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; dense.size(); ++i)</div>
<div class="line">                result.data_ptr()[i] = dense.data_ptr()[i];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Mark all entries as initialized</span></div>
<div class="line">        std::fill(result.init_ptr(), result.init_ptr() + result.size(), 1);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add sparse values</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; sparse.nonzero_count(); ++i) {</div>
<div class="line">            std::size_t r = sparse.row_index(i);</div>
<div class="line">            std::size_t c = sparse.col_index(i);</div>
<div class="line">            result.update(r, c, result(r, c) + sparse.value(i));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ae726d568aa0e281c4bd86d71f337b8c4">operator+</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; sparse, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; dense) {</div>
<div class="line">        <span class="keywordflow">if</span> (dense.rows() != sparse.rows() || dense.cols() != sparse.cols())</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for addition&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; result(dense.rows(), dense.cols());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Copy dense matrix data to result</span></div>
<div class="line">        <span class="keywordflow">if</span> constexpr (simd_traits&lt;T&gt;::supported) {</div>
<div class="line">            simd_ops&lt;T&gt;::copy(dense.data_ptr(), result.data_ptr(), dense.size());</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; dense.size(); ++i)</div>
<div class="line">                result.data_ptr()[i] = dense.data_ptr()[i];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Mark all entries as initialized</span></div>
<div class="line">        std::fill(result.init_ptr(), result.init_ptr() + result.size(), 1);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add sparse values</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; sparse.nonzero_count(); ++i) {</div>
<div class="line">            std::size_t r = sparse.row_index(i);</div>
<div class="line">            std::size_t c = sparse.col_index(i);</div>
<div class="line">            result.update(r, c, result(r, c) + sparse.value(i));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    SparseCOOMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ab7a55d8c976eb591ad233a83bffc43ce">operator-</a>(T scalar, <span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; matrix) {</div>
<div class="line">        SparseCOOMatrix&lt;T&gt; result(matrix.rows(), matrix.cols());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; matrix.nonzero_count(); ++i) {</div>
<div class="line">            std::size_t r = matrix.row_index(i);</div>
<div class="line">            std::size_t c = matrix.col_index(i);</div>
<div class="line">            T val = scalar - matrix.value(i);</div>
<div class="line">            result.set(r, c, val);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ab7a55d8c976eb591ad233a83bffc43ce">operator-</a>(<span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; sparse, <span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; dense) {</div>
<div class="line">        <span class="keywordflow">if</span> (sparse.rows() != dense.rows() || sparse.cols() != dense.cols())</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for subtraction&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; result(dense.rows(), dense.cols());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Negate dense matrix and store in result</span></div>
<div class="line">        <span class="keywordflow">if</span> constexpr (simd_traits&lt;T&gt;::supported) {</div>
<div class="line">            simd_ops&lt;T&gt;::mul_scalar(dense.data_ptr(), <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(-1), result.data_ptr(), dense.size());</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; dense.size(); ++i)</div>
<div class="line">                result.data_ptr()[i] = -dense.data_ptr()[i];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Mark all entries as initialized</span></div>
<div class="line">        std::fill(result.init_ptr(), result.init_ptr() + result.size(), 1);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add sparse matrix values to result</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; sparse.nonzero_count(); ++i) {</div>
<div class="line">            std::size_t r = sparse.row_index(i);</div>
<div class="line">            std::size_t c = sparse.col_index(i);</div>
<div class="line">            result.update(r, c, result(r, c) + sparse.value(i));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">// -------------------------------------------------------------------------------- </span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">    DenseMatrix&lt;T&gt; <a class="code" href="namespaceslt.html#ab7a55d8c976eb591ad233a83bffc43ce">operator-</a>(<span class="keyword">const</span> DenseMatrix&lt;T&gt;&amp; dense, <span class="keyword">const</span> SparseCOOMatrix&lt;T&gt;&amp; sparse) {</div>
<div class="line">        <span class="keywordflow">if</span> (sparse.rows() != dense.rows() || sparse.cols() != dense.cols()) {</div>
<div class="line">            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Matrix dimensions must match for subtraction&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        DenseMatrix&lt;T&gt; result(dense.rows(), dense.cols());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Copy dense values</span></div>
<div class="line">        <span class="keywordflow">if</span> constexpr (simd_traits&lt;T&gt;::supported) {</div>
<div class="line">            simd_ops&lt;T&gt;::copy(dense.data_ptr(), result.data_ptr(), dense.size());</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; dense.size(); ++i) {</div>
<div class="line">                result.data_ptr()[i] = dense.data_ptr()[i];</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Mark all entries as initialized</span></div>
<div class="line">        std::fill(result.init_ptr(), result.init_ptr() + result.size(), 1);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Subtract sparse values</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; sparse.nonzero_count(); ++i) {</div>
<div class="line">            std::size_t r = sparse.row_index(i);</div>
<div class="line">            std::size_t c = sparse.col_index(i);</div>
<div class="line">            result.update(r, c, result(r, c) - sparse.value(i));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line">} <span class="comment">// namespace slt</span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="comment">// ================================================================================ </span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* MATRIX_HPP */</span><span class="preprocessor"></span></div>
<div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// ================================================================================</span></div>
<div class="line"><span class="comment">// eof</span></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html"><div class="ttname"><a href="classslt_1_1DenseMatrix.html">slt::DenseMatrix</a></div><div class="ttdoc">A dense matrix implementation supporting float or double values.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:736</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a01bfb57f1f4c7f11110926bd3625834a"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a01bfb57f1f4c7f11110926bd3625834a">slt::DenseMatrix::operator+</a></div><div class="ttdeci">DenseMatrix operator+(const DenseMatrix &amp;other) const</div><div class="ttdoc">Adds two DenseMatrix objects element-wise.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1353</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a02b7df353b3562388432f1bbbb8bab54"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a02b7df353b3562388432f1bbbb8bab54">slt::DenseMatrix::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">The total size of the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:752</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a0439627319cdaed291451c4135c33c2b"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a0439627319cdaed291451c4135c33c2b">slt::DenseMatrix::print</a></div><div class="ttdeci">void print(std::ostream &amp;os=std::cout) const</div><div class="ttdoc">Prints the contents of the matrix to the given output stream.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1902</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a06b7efc75ec0ecfa24c628b422f73f53"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a06b7efc75ec0ecfa24c628b422f73f53">slt::DenseMatrix::set</a></div><div class="ttdeci">void set(std::size_t row, std::size_t col, T value) override</div><div class="ttdoc">Sets the value at the given matrix index, marking it as initialized.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1776</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a09a6958aa43a7ead237b48114527ef5b"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a09a6958aa43a7ead237b48114527ef5b">slt::DenseMatrix::transpose</a></div><div class="ttdeci">void transpose()</div><div class="ttdoc">Transposes the matrix in-place.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1593</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a1cee72c413fc6a704706569e9571243d"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a1cee72c413fc6a704706569e9571243d">slt::DenseMatrix::rows_</a></div><div class="ttdeci">std::size_t rows_</div><div class="ttdoc">Number of rows.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:743</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a33d3181181df8997b1f81135ba6fe1d2"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a33d3181181df8997b1f81135ba6fe1d2">slt::DenseMatrix::nonzero_count</a></div><div class="ttdeci">std::size_t nonzero_count() const</div><div class="ttdoc">Returns the number of initialized elements in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:880</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a36182695820d97a3e651f6cdb93faf0a"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a36182695820d97a3e651f6cdb93faf0a">slt::DenseMatrix::operator/</a></div><div class="ttdeci">DenseMatrix operator/(T scalar) const</div><div class="ttdoc">Divide all matrix elements by a scalar.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1556</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a4f16ef2fe485bfeaff37e07be5cbb437"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a4f16ef2fe485bfeaff37e07be5cbb437">slt::DenseMatrix::operator=</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; &amp; operator=(const DenseMatrix&lt; T &gt; &amp;other)</div><div class="ttdoc">Copy assignment operator for DenseMatrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1279</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a529848163b44a2168460198adda171f7"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a529848163b44a2168460198adda171f7">slt::DenseMatrix::data_ptr</a></div><div class="ttdeci">const T * data_ptr() const</div><div class="ttdoc">Pointer to the first value within the data array.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:784</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a631142d8a7cbb38a6e8210569e8605d4"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a631142d8a7cbb38a6e8210569e8605d4">slt::DenseMatrix::init_ptr</a></div><div class="ttdeci">const uint8_t * init_ptr() const</div><div class="ttdoc">Pointer to the first value within the init array.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:850</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a64113fe72d74abc3e8f957e5f0bbee9e"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a64113fe72d74abc3e8f957e5f0bbee9e">slt::DenseMatrix::get</a></div><div class="ttdeci">T get(std::size_t row, std::size_t col) const override</div><div class="ttdoc">Retrieves a copy of the value at the specified matrix index.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1743</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a64a5482eb0dbba6aa16825fda6eac2ac"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a64a5482eb0dbba6aa16825fda6eac2ac">slt::DenseMatrix::operator-</a></div><div class="ttdeci">DenseMatrix operator-(const DenseMatrix &amp;other) const</div><div class="ttdoc">Element-wise matrix subtraction.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1421</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a66bf4b77281db6ded265fc44f8b3a309"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a66bf4b77281db6ded265fc44f8b3a309">slt::DenseMatrix::clone</a></div><div class="ttdeci">std::unique_ptr&lt; MatrixBase&lt; T &gt; &gt; clone() const override</div><div class="ttdoc">Creates a deep copy of the current matrix instance.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1868</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a77c081ccac829706e7b345faf2acf42d"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a77c081ccac829706e7b345faf2acf42d">slt::DenseMatrix::operator()</a></div><div class="ttdeci">T &amp; operator()(std::size_t r, std::size_t c)</div><div class="ttdoc">Access or assign a value at the specified matrix index (r, c).</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1215</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_a8ff8f8302614df9bc21407878384eaf2"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#a8ff8f8302614df9bc21407878384eaf2">slt::DenseMatrix::cols_</a></div><div class="ttdeci">std::size_t cols_</div><div class="ttdoc">Number of cols.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:744</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_aa051172f51cb694e62d2ac92212e2b42"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#aa051172f51cb694e62d2ac92212e2b42">slt::DenseMatrix::update</a></div><div class="ttdeci">void update(std::size_t row, std::size_t col, T value)</div><div class="ttdoc">Updates the value at the given matrix index, assuming it is already initialized.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1841</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ab28b2210e92edcb57fb8d042e185571f"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ab28b2210e92edcb57fb8d042e185571f">slt::DenseMatrix::operator*</a></div><div class="ttdeci">DenseMatrix operator*(const DenseMatrix &amp;other) const</div><div class="ttdoc">Element-wise matrix multiplication.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1490</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ab63789902cfdc1e5cbf8e0777f5c9fb9"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ab63789902cfdc1e5cbf8e0777f5c9fb9">slt::DenseMatrix::data</a></div><div class="ttdeci">std::vector&lt; T &gt; data</div><div class="ttdoc">Flat row-major storage of matrix elements.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:741</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ac182317252d8e104ea9be539358fe1b2"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ac182317252d8e104ea9be539358fe1b2">slt::DenseMatrix::cols</a></div><div class="ttdeci">std::size_t cols() const override</div><div class="ttdoc">Returns the number of columns in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1719</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ae55af06b38c452c75279bbfe4d0abaf4"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ae55af06b38c452c75279bbfe4d0abaf4">slt::DenseMatrix::remove</a></div><div class="ttdeci">void remove(std::size_t row, std::size_t col)</div><div class="ttdoc">Removes a value from the matrix by clearing its data and initialization flag.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1809</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ae6666df109b2705e298cae85028014b6"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ae6666df109b2705e298cae85028014b6">slt::DenseMatrix::rows</a></div><div class="ttdeci">std::size_t rows() const override</div><div class="ttdoc">Returns the number of rows in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1704</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ae7443b52dd5c9229b1e57836c62734e5"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ae7443b52dd5c9229b1e57836c62734e5">slt::DenseMatrix::inverse</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; inverse() const</div><div class="ttdoc">Computes and returns the inverse of a square matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1629</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_ae860a596275b6746c9c8e4a39a8671f5"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#ae860a596275b6746c9c8e4a39a8671f5">slt::DenseMatrix::init</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; init</div><div class="ttdoc">A vector containin a binary representation of array initialization.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:742</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_aecc5061bed3861b391292058e43ae1b2"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#aecc5061bed3861b391292058e43ae1b2">slt::DenseMatrix::is_initialized</a></div><div class="ttdeci">bool is_initialized(std::size_t row, std::size_t col) const override</div><div class="ttdoc">Checks whether a specific matrix element has been initialized.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1930</div></div>
<div class="ttc" id="aclassslt_1_1DenseMatrix_html_aefb68f3c5f27bd69a67d1e1f7b51831e"><div class="ttname"><a href="classslt_1_1DenseMatrix.html#aefb68f3c5f27bd69a67d1e1f7b51831e">slt::DenseMatrix::DenseMatrix</a></div><div class="ttdeci">DenseMatrix(std::size_t r, std::size_t c, T value)</div><div class="ttdoc">Constructs a matrix with given dimensions and fills it with a specified value.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:917</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_a069249b28295c9776df81efed6076589"><div class="ttname"><a href="classslt_1_1MatrixBase.html#a069249b28295c9776df81efed6076589">slt::MatrixBase::is_initialized</a></div><div class="ttdeci">virtual bool is_initialized(std::size_t row, std::size_t col) const =0</div><div class="ttdoc">Determines if a row column pair is initialized.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_a10ca9a5de506b53de715596507c77321"><div class="ttname"><a href="classslt_1_1MatrixBase.html#a10ca9a5de506b53de715596507c77321">slt::MatrixBase::clone</a></div><div class="ttdeci">virtual std::unique_ptr&lt; MatrixBase&lt; T &gt; &gt; clone() const =0</div><div class="ttdoc">Creates a polymorphic copy of the matrix object.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_a2925cbdba8ec46c258f8d8e1fb1b730d"><div class="ttname"><a href="classslt_1_1MatrixBase.html#a2925cbdba8ec46c258f8d8e1fb1b730d">slt::MatrixBase::set</a></div><div class="ttdeci">virtual void set(std::size_t row, std::size_t col, T value)=0</div><div class="ttdoc">Sets the value at a specific matrix coordinate.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_a3bbb4cd026c2c1da1ba0881c918630b1"><div class="ttname"><a href="classslt_1_1MatrixBase.html#a3bbb4cd026c2c1da1ba0881c918630b1">slt::MatrixBase::~MatrixBase</a></div><div class="ttdeci">virtual ~MatrixBase()=default</div><div class="ttdoc">Virtual destructor for safe polymorphic deletion.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_a5fe460dc2d97ee440c32635d5f3192fc"><div class="ttname"><a href="classslt_1_1MatrixBase.html#a5fe460dc2d97ee440c32635d5f3192fc">slt::MatrixBase::get</a></div><div class="ttdeci">virtual T get(std::size_t row, std::size_t col) const =0</div><div class="ttdoc">Retrieves the value at a specific matrix coordinate.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_acee40c97e44474a9619b808b63d1868b"><div class="ttname"><a href="classslt_1_1MatrixBase.html#acee40c97e44474a9619b808b63d1868b">slt::MatrixBase::cols</a></div><div class="ttdeci">virtual std::size_t cols() const =0</div><div class="ttdoc">Returns the number of columns in the matrix.</div></div>
<div class="ttc" id="aclassslt_1_1MatrixBase_html_af5247088bf3743574e25430da458ff46"><div class="ttname"><a href="classslt_1_1MatrixBase.html#af5247088bf3743574e25430da458ff46">slt::MatrixBase::rows</a></div><div class="ttdeci">virtual std::size_t rows() const =0</div><div class="ttdoc">Returns the number of rows in the matrix.</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a0d82d6bb156ed5dbb372bb7c8155b7d5"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a0d82d6bb156ed5dbb372bb7c8155b7d5">slt::SparseCOOMatrix::col_index</a></div><div class="ttdeci">std::size_t col_index(std::size_t i) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2266</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a1ccef3397e1eeb5c9a4a1e895ff25866"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a1ccef3397e1eeb5c9a4a1e895ff25866">slt::SparseCOOMatrix::cols</a></div><div class="ttdeci">std::size_t cols() const override</div><div class="ttdoc">Returns the number of columns in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2748</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a1d5ba6c9996a3b093529cc4f135079d5"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a1d5ba6c9996a3b093529cc4f135079d5">slt::SparseCOOMatrix::cols_</a></div><div class="ttdeci">std::size_t cols_</div><div class="ttdoc">Matrix dimensions.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2242</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a1dc02d00cac074d3771223b358de6152"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a1dc02d00cac074d3771223b358de6152">slt::SparseCOOMatrix::operator==</a></div><div class="ttdeci">bool operator==(const SparseCOOMatrix&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2494</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a26f9d4289054f90dc5248edee3385f2d"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a26f9d4289054f90dc5248edee3385f2d">slt::SparseCOOMatrix::row_index</a></div><div class="ttdeci">std::size_t row_index(std::size_t i) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2261</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a30d1204d80d8b51f20217c5af322a2da"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a30d1204d80d8b51f20217c5af322a2da">slt::SparseCOOMatrix::update</a></div><div class="ttdeci">void update(std::size_t r, std::size_t c, T value)</div><div class="ttdoc">Updates an existing value in the matrix at (row, column).</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2870</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a3401da28257fbe2af0fcd501b5fe0ea4"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a3401da28257fbe2af0fcd501b5fe0ea4">slt::SparseCOOMatrix::data</a></div><div class="ttdeci">std::vector&lt; T &gt; data</div><div class="ttdoc">Flat row-major storage of matrix elements.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2239</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a532cedb759d6e7e633c4a3ad84f17c69"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a532cedb759d6e7e633c4a3ad84f17c69">slt::SparseCOOMatrix::clone</a></div><div class="ttdeci">std::unique_ptr&lt; MatrixBase&lt; T &gt; &gt; clone() const override</div><div class="ttdoc">Creates a polymorphic deep copy of this matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2797</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a562d500b4202fbc2afb7123571ac6d60"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a562d500b4202fbc2afb7123571ac6d60">slt::SparseCOOMatrix::operator*</a></div><div class="ttdeci">SparseCOOMatrix operator*(const SparseCOOMatrix &amp;other) const</div><div class="ttdoc">Performs element-wise multiplication of two sparse matrices.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2720</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a5bc2a8f7766afa09ceaf18d83447875f"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a5bc2a8f7766afa09ceaf18d83447875f">slt::SparseCOOMatrix::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Returns the total number of elments in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2259</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a7cf8f962d4fa6ec16575c0e7031e3447"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a7cf8f962d4fa6ec16575c0e7031e3447">slt::SparseCOOMatrix::value</a></div><div class="ttdeci">T value(std::size_t i) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2271</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a8060856161b5989ab2f30b87d8d5bf71"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a8060856161b5989ab2f30b87d8d5bf71">slt::SparseCOOMatrix::get</a></div><div class="ttdeci">T get(std::size_t r, std::size_t c) const override</div><div class="ttdoc">Gets a matrix element.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2760</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a8066b8bab1b1db44570b043591547447"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a8066b8bab1b1db44570b043591547447">slt::SparseCOOMatrix::operator=</a></div><div class="ttdeci">SparseCOOMatrix&lt; T &gt; &amp; operator=(const SparseCOOMatrix&lt; T &gt; &amp;other)</div><div class="ttdoc">Deep copy assignment operator.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2524</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a82dc765141e8635009ff85e9f1c1b1f6"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a82dc765141e8635009ff85e9f1c1b1f6">slt::SparseCOOMatrix::rows_</a></div><div class="ttdeci">std::size_t rows_</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2242</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a869a28d52e8cf7658dc8cc87a9bfcc6d"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a869a28d52e8cf7658dc8cc87a9bfcc6d">slt::SparseCOOMatrix::operator-</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; operator-(const SparseCOOMatrix&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2662</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_a92b8c482627448d29d112af92da1afb8"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#a92b8c482627448d29d112af92da1afb8">slt::SparseCOOMatrix::operator+</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; operator+(const SparseCOOMatrix&lt; T &gt; &amp;other) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2587</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_aa8f0e3fdab670152566ce8353a9c42fa"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#aa8f0e3fdab670152566ce8353a9c42fa">slt::SparseCOOMatrix::rows</a></div><div class="ttdeci">std::size_t rows() const override</div><div class="ttdoc">Returns the number of rows in the matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2742</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_ab890c296bec63f265a2c1cd167a88eec"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#ab890c296bec63f265a2c1cd167a88eec">slt::SparseCOOMatrix::fast_set</a></div><div class="ttdeci">bool fast_set</div><div class="ttdoc">true if vectors are optimized for insertation, false if optimized for retrieval</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2247</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_ab948cfcf480803e9469c735807d31d6e"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#ab948cfcf480803e9469c735807d31d6e">slt::SparseCOOMatrix::set</a></div><div class="ttdeci">void set(std::size_t r, std::size_t c, T value) override</div><div class="ttdoc">Sets a value in the matrix at the given (row, column) index.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2819</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_abb078adcd4c95de5d7bddbe438a06316"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#abb078adcd4c95de5d7bddbe438a06316">slt::SparseCOOMatrix::operator()</a></div><div class="ttdeci">T operator()(std::size_t r, std::size_t c) const</div><div class="ttdoc">Accesses a matrix element (read-only).</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2453</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_ac9ea84ab29c1ac833854de16386b60fb"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#ac9ea84ab29c1ac833854de16386b60fb">slt::SparseCOOMatrix::col</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; col</div><div class="ttdoc">A vector containing column indices.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2246</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_aec54f3c4530a3c503131a2b37b19c5a4"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#aec54f3c4530a3c503131a2b37b19c5a4">slt::SparseCOOMatrix::row</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; row</div><div class="ttdoc">A vector containing row indices.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2245</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_aeffd4e5b6e6d980855f1dc31d964188b"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#aeffd4e5b6e6d980855f1dc31d964188b">slt::SparseCOOMatrix::nonzero_count</a></div><div class="ttdeci">std::size_t nonzero_count() const</div><div class="ttdoc">Returns the size of the data array.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2260</div></div>
<div class="ttc" id="aclassslt_1_1SparseCOOMatrix_html_afdf817cb3a1cfdd63825edd72b7af332"><div class="ttname"><a href="classslt_1_1SparseCOOMatrix.html#afdf817cb3a1cfdd63825edd72b7af332">slt::SparseCOOMatrix::SparseCOOMatrix</a></div><div class="ttdeci">SparseCOOMatrix(std::size_t r, std::size_t c, bool fastInsert=true)</div><div class="ttdoc">Constructs an empty sparse COO matrix with given dimensions.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2285</div></div>
<div class="ttc" id="amatrix_8hpp_html_ac5a637320d99ebb9eaa016046afb1462"><div class="ttname"><a href="matrix_8hpp.html#ac5a637320d99ebb9eaa016046afb1462">SIMD_WIDTH_FLOAT</a></div><div class="ttdeci">#define SIMD_WIDTH_FLOAT</div><div class="ttdef"><b>Definition:</b> matrix.hpp:40</div></div>
<div class="ttc" id="amatrix_8hpp_html_aeda68842866e63a7a2cbcd69ac99a1ba"><div class="ttname"><a href="matrix_8hpp.html#aeda68842866e63a7a2cbcd69ac99a1ba">SIMD_WIDTH_DOUBLE</a></div><div class="ttdeci">#define SIMD_WIDTH_DOUBLE</div><div class="ttdef"><b>Definition:</b> matrix.hpp:41</div></div>
<div class="ttc" id="anamespaceslt_html"><div class="ttname"><a href="namespaceslt.html">slt</a></div><div class="ttdef"><b>Definition:</b> matrix.hpp:46</div></div>
<div class="ttc" id="anamespaceslt_html_a1edc8aa1413efcf30b6b2317064465a3"><div class="ttname"><a href="namespaceslt.html#a1edc8aa1413efcf30b6b2317064465a3">slt::dot</a></div><div class="ttdeci">T dot(const T *a, const T *b, std::size_t size)</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2067</div></div>
<div class="ttc" id="anamespaceslt_html_a4a91f90ca1405d694326b5ec7e8d3be7"><div class="ttname"><a href="namespaceslt.html#a4a91f90ca1405d694326b5ec7e8d3be7">slt::cross</a></div><div class="ttdeci">void cross(const T *a, const T *b, T *result)</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2102</div></div>
<div class="ttc" id="anamespaceslt_html_a65e705fbd81f19d98c1fcf81ef098e2c"><div class="ttname"><a href="namespaceslt.html#a65e705fbd81f19d98c1fcf81ef098e2c">slt::mat_mul</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; mat_mul(const DenseMatrix&lt; T &gt; &amp;A, const DenseMatrix&lt; T &gt; &amp;B)</div><div class="ttdoc">Perform standard matrix multiplication (A  B) for dense matrices.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2172</div></div>
<div class="ttc" id="anamespaceslt_html_a7a4f1a42d7dfbc00af75ce9cb1ec6d8b"><div class="ttname"><a href="namespaceslt.html#a7a4f1a42d7dfbc00af75ce9cb1ec6d8b">slt::operator*</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; operator*(T scalar, const DenseMatrix&lt; T &gt; &amp;matrix)</div><div class="ttdoc">Multiplies each element of a matrix by a scalar.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2061</div></div>
<div class="ttc" id="anamespaceslt_html_ab7a55d8c976eb591ad233a83bffc43ce"><div class="ttname"><a href="namespaceslt.html#ab7a55d8c976eb591ad233a83bffc43ce">slt::operator-</a></div><div class="ttdeci">slt::DenseMatrix&lt; T &gt; operator-(T scalar, const slt::DenseMatrix&lt; T &gt; &amp;matrix)</div><div class="ttdoc">Subtracts each element of a matrix from a scalar.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2018</div></div>
<div class="ttc" id="anamespaceslt_html_adbc6a9912aba420a4fe67ba6abd729a9"><div class="ttname"><a href="namespaceslt.html#adbc6a9912aba420a4fe67ba6abd729a9">slt::operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const DenseMatrix&lt; T &gt; &amp;mat)</div><div class="ttdoc">Stream output operator for DenseMatrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1947</div></div>
<div class="ttc" id="anamespaceslt_html_ae726d568aa0e281c4bd86d71f337b8c4"><div class="ttname"><a href="namespaceslt.html#ae726d568aa0e281c4bd86d71f337b8c4">slt::operator+</a></div><div class="ttdeci">DenseMatrix&lt; T &gt; operator+(T scalar, const DenseMatrix&lt; T &gt; &amp;matrix)</div><div class="ttdoc">Adds a scalar to each initialized element of a matrix.</div><div class="ttdef"><b>Definition:</b> matrix.hpp:1983</div></div>
<div class="ttc" id="astructslt_1_1SparseCOOMatrix_1_1COOComparator_html_a443e01d2641ec82d3430c70cfa9647bf"><div class="ttname"><a href="structslt_1_1SparseCOOMatrix_1_1COOComparator.html#a443e01d2641ec82d3430c70cfa9647bf">slt::SparseCOOMatrix::COOComparator::operator()</a></div><div class="ttdeci">bool operator()(std::pair&lt; std::size_t, std::size_t &gt; a, std::pair&lt; std::size_t, std::size_t &gt; b) const</div><div class="ttdef"><b>Definition:</b> matrix.hpp:2251</div></div>
<div class="ttc" id="astructslt_1_1simd__traits_html_a4250fe797cbbc73a64195b10f199f277"><div class="ttname"><a href="structslt_1_1simd__traits.html#a4250fe797cbbc73a64195b10f199f277">slt::simd_traits::supported</a></div><div class="ttdeci">static constexpr bool supported</div><div class="ttdef"><b>Definition:</b> matrix.hpp:56</div></div>
<div class="ttc" id="astructslt_1_1simd__traits_html_a4d27bcf5a07aeaa4ee8af03ce93ee830"><div class="ttname"><a href="structslt_1_1simd__traits.html#a4d27bcf5a07aeaa4ee8af03ce93ee830">slt::simd_traits::width</a></div><div class="ttdeci">static constexpr std::size_t width</div><div class="ttdef"><b>Definition:</b> matrix.hpp:57</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
